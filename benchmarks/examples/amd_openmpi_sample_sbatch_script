#!/bin/bash
#SBATCH --job-name=testMPI
#SBATCH --output=output.txt
#SBATCH --partition=normal
#SBATCH -N 2 --nodelist=springnode00003.spring.test,springnode00004.spring.test

pwd; hostname; date

# Exporting enviorment variables
source /<aocc_install_location>/setenv_AOCC.sh
export PATH=<slurm_nfs_share>/benchmarks/openmpi-<openmpi_version>/openmpi/bin:$PATH
export LD_LIBRARY_PATH=<slurm_nfs_share>/benchmarks/openmpi-<openmpi_version>/openmpi/lib:$LD_LIBRARY_PATH

#Below command can be used to run mpirun command jobfrom NFS share
cd <slurm_nfs_share>/benchmarks/amd-zen-hpl-2024_10_08
mpirun -np 2 --mca orte_keep_fqdn_hostnames 1 ./xhpl

#Below command can be used to run job from NFS share
#cd <slurm_nfs_share>/benchmarks/amd-zen-hpl-2024_10_08
#srun -N 2 --mpi=pmix_v3 -n 2 ./xhpl

date
