{% if hostvars['localhost']['k8s_offline_install'] %}
server = "https://{{ pulp_server_ip }}:{{ pulp_registry_port }}"

[host."http://{{ pulp_server_ip }}:{{ pulp_registry_port }}"]
  capabilities = ["pull","resolve"]
  skip_verify = {{ skip_verify | default(true) | lower | regex_replace('["\']', '') }}
  override_path = {{ override_path | default(false) | lower | regex_replace('["\']', '') }}
{% else %}
server = "https://registry-1.docker.io"
{% endif %}

# Fallbacks for each known registry
[host."https://registry-1.docker.io"]
  capabilities = ["pull", "resolve"]
  skip_verify = false
  override_path = false

[host."https://ghcr.io"]
  capabilities = ["pull", "resolve"]
  skip_verify = false
  override_path = false

[host."https://quay.io"]
  capabilities = ["pull", "resolve"]
  skip_verify = false
  override_path = false

[host."https://registry.k8s.io"]
  capabilities = ["pull", "resolve"]
  skip_verify = false
  override_path = false

[host."https://nvcr.io"]
  capabilities = ["pull", "resolve"]
  skip_verify = false
  override_path = false

[host."https://public.ecr.aws"]
  capabilities = ["pull", "resolve"]
  skip_verify = false
  override_path = false

[host."https://gcr.io"]
  capabilities = ["pull", "resolve"]
  skip_verify = false
  override_path = false
